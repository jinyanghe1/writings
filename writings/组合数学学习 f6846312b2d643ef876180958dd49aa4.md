# 组合数学学习

# 组合问题介绍

问题引入：什么时候能用$1\times 2$的骨牌得到对棋盘的**完美覆盖**？

对于一个$m\times n$的棋盘，它能被完美覆盖$\iff$$2$整除$m$或$2$整除$n$。

进一步，如果将骨牌变为$1\times b$的呢？

1. 对于$m\times n$的棋盘，如果存在用$1\times b$的骨牌的完美覆盖，则$b\mid m \lor b\mid n$。

另一个问题：**切立方体**。给定一个大的立方体，能不能用少于六刀将其切成二十七块小的立方体？

# 鸽巢原理

**鸽巢原理**的简单表述：$n+1$个球放到$n$个盒子里，至少有一个盒子有$\geq 2$个球。

**简单的推广**：$n$个球放到$n$个盒子，要求每个盒子非空，则每个盒子至多有$1$个球。

**简单的应用**：$\{a\}:=a_1,a_2,\dots,a_m$连续$m$个数(，一定有一个数可以被$m$整除。

证明：

$$
 1. \text{如果找到可以被整除的，证毕}\\ 2.\text{由鸽笼原理，如果没有被整除的，则有}a_i,a_j\text{对}m\text{同余。}\\ \text{设余数为}k<m\text{，则一定有}a_p=pm+(m-k)\\ \implies m\mid a_p+a_i \\ \implies \exist n, s.t. a_o:=a_p+a_i-n(a_j-a_i)\ \ ,\\ \ m\mid a_o \land a_o\in[a_1,a_m]
$$

---

**另一个应用：国际象棋。**一位棋手每天至少下一盘棋，每周最多下十二盘棋，持续$11$周。证明，一定有连续的若干天，他刚好一共下了$21$盘棋。

证明：

$$
\text{设第}i\text{天下了}x_i\text{盘棋。令}s_i:=\sum_{n=1}^ix_i\\ \text{令}T_j=s_j+21\\ \text{只要证明}\exist p,j,T_j=s_p\\ \text{对于}S: 1\leq S_1<S_2<\dots<S_{77}\leq 132\\ \text{对于}T: 22\leq T_1<T_2\dots<T_{77}\leq 153\\ \text{观察到}S\text{和}T\text{共有}154\text{个，同时取值方案为}153 \\ \text{由抽屉原理得证一定}\exist p,j,\ \ s.t.\ \ T_j=s_p
$$

希望知道：最少需要几周才能达到这个目标？

**下面证明只需要三周就能满足：**

沿用上面的定义，有$s_i$被$21$除的数要么

1. $\exist i,s.t.\ \ 21\mid s_i$，又因为$s_i\leq 36$，得证。
2. 如果没有，从上面讨论可以得出$\exist p,q,s.t.\ \ 21\mid s_q-s_t，$得证。

---

**另例：整除。**从$1$到$200$中随意选出$101$个数，证明其中至少有两个数，其中一个可以整除另一个。

证明：记$a_i:=2^{r_i}s_i,s_i$是奇数。可以看到$s_i$的取值有$100$种。进而由鸽笼原理，必然有$a_i=2^{r_i}s_p,\ \ a_j=2^{r_j}s_p$，这两个数满足题设条件。

---

**中国剩余定理：**

$(m,n)=1$，$0\leq a\leq m-1,\ \ 0\leq b\leq n-1$，则$\exist x,s.t.\ \ x\equiv a(mod\ m),\ \ x\equiv b(mod\ n)$

证明：

被$m$除余$a$的数有$a,m+a,2m+a,\dots,(n-1)m+a$一共$n$个。

如果能够证明这些数被$n$除，余数都互不相同，那么就可以证明里面一定有一个数被$n$除余$b$。

下面考虑反证法：如果$(im+a),(jm+a)$被$n$除余数相同，则有

$$
n\mid (im+a)-(jm+a)\implies\ \ n\mid (i-j)m\\ \implies \ \ n\mid (i-j)
$$

很显然这与$0\leq i\ne j\leq n-1$是矛盾的。

---

**鸽巢原理的加强：**

将$q_1+q_2+\dots+q_n-n+1$个物体放到$n$个盒子中，则：

第一个盒子有至少$q_1$个或第二个盒子有至少$q_2$个或…或第$n$个盒子有至少$q_n$个。

证明：由反证法易证。

---

**例：**放水果。将一些苹果放到三个篮子中，要求第一个篮子至少有$8$个，或者第二个篮子至少有$6$个，或者第三个篮子至少有$9$个。至少需要多少个水果？

**解**：$n=3,\ \ q_1=8,\ \ q_2=6,\ \ q_3=9$。$N=q_1+q_2+q_3-n+1=8+6+9-3+1=21$.

---

**鸽巢原理重要应用：Ramsay数。**

对于一个图，如果图上的所有点都与其他点有边相连，则这个图为完全图。有$n$个顶点的完全图记作$K_n$。

**例：**任意$6$个人中，有$3$个人互相认识或者互相不认识。

令每个人代表一个顶点，两人相互认识代表用红边相连，不认识代表用蓝边相连。三个人互相认识/不认识代表红色/蓝色的三角形。

由鸽笼原理，一个顶点要么至少连出三个同色边，不妨设为三条红边。对于连出的三个顶点，为了不形成红色三角形，互相只能用蓝边相连，但这样便会形成蓝色的三角形，得证。

**Ramsay数：$r(m,n)$，**表示要找这样一个最小的数$N$，使得$N$个人中必定有$m$个人相识或$n$个人互不相识。

**推广：$r(n_1,n_2,\dots,n_k)$。**如$r(3,3,3)=17$，表示$K_{17}$中至少可以找到一个$K_3$。

# 排列与组合

**定理：$C_n^0+C_n^1+\dots+C_n^n=2^n$。**

# 二项式系数

**重要定理：$C_n^k=C_{n-1}^k+C_{n-1}^{k-1}$。**

这个定理的证明是比较简单的。可以根据组合数的定义，对右边进行化简得到左边。

下面给出使用组合方法的证明：

考虑一个$n$元集合$S$，$C_n^k$代表在其中选出$k$元子集的方法数。现在考虑$x\in S$，在所有选法$C_i$中，必有$x\in C_i$或$x\notin C_i$，分别对应方法数$C_{n-1}^{k-1}$（已经选了$x$，在剩余的$n-1$个元素中选出$k-1$个）和$C_{n-1}^k$（不选$x$，在$n-1$个元素中选出$k$个）。

**二项式定理：**

$$
(x+y)^n=\sum_{i=0}^nC_n^ix^iy^{n-i}
$$

这个定理的证明是比较简单的，可以使用组合方法进行证明，也可以使用数学归纳法。

这个定理有一个非常有用的推广。取$y=1$，我们有：

$$
(1+x)^n=\sum_{i=0}^nC_n^ix^i
$$

取$x=y=1$，则有：

$$
\sum_{i=0}^nC_n^i=2^n
$$

取$x=1,\ \ y=-1$，有：

$$
0=C_n^0-C_n^1+\dots+(-1)^nC_n^n
$$

整理得：

$$
2^{n-1}=C_n^0+C_n^2+\dots+ \\ =C_n^1+C_n^3+\dots+
$$

下面的式子可以衍生出很多组合恒等式：

$$
\begin{aligned}&(1+x)^n=\sum_{i=0}^nC_n^ix^i \\ &\text{两边求导}\\ & n(1+x)^{n-1}=\sum_{i=0}^niC_n^ix^{i-1} \\  &\text{两边从0到1积分} \\ &\frac{1}{n+1}(2^{n+1}-1)=\sum_{i=0}^n \frac{1}{i+1}C_n^i\end{aligned}
$$

**多项式定理：**

$$
(x+y+z)^n=\sum_{k=0}^n\sum_{l=0}^{n-k}\frac{n!}{k!l!(n-k-l)!}x^ky^lz^{n-k-l}
$$

令$r:=n-k-l$，上式可以写成：

$$
\sum_{k+l+r=n}\frac{n!}{k!l!r!}x^ky^lz^r
$$

类似地，可以推广为：

$$
(x_1+x_2+\dots+x_m)^n\\ = \sum_{\sum p_i=n}\frac{n!}{\Pi_{i=1}^n (p_i!)}\Pi_{i=1}^nx_i^{p_i} \\ =\sum_{\sum p_i=n} n!\Pi_{i=1}^n \frac{1}{p_i!}x_i^{p_i}
$$